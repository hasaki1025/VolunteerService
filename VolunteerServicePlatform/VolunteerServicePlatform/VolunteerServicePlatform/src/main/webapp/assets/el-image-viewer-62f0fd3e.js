import{i as be,m as fe,a as B,k as ke,b as Ie}from "./index-6827869e.js";import{w as _e,v as ze,T as Ee}from "./runtime-dom.esm-bundler-f55edbfc.js";import{f as N,b as ve,g as le,i as ce,h as Le,s as Ce,u as me,E as O,j as Te,a as Oe,c as Se,z as xe,k as Ne,r as Re,l as $e,_ as pe,w as ge,m as Ae,n as Ve}from "./base-f09cc819.js";import{d as Be,u as we,a as Me,E as V,g as De}from "./index-20038826.js";import{W as Q,J as de,I as b,H as Ye,U as Fe,T as k,K as oe,R as ye,a3 as he,o as I,a5 as re,a as d,Z as E,Y as m,a7 as f,V as e,aa as ie,a8 as _,c as S,F as ue,ai as He,ab as Xe,a6 as Pe,a9 as J,aj as je,ak as We,ae as Ze,ac as Ke,b as Ue}from "./_plugin-vue_export-helper-64f54b45.js";var qe="Expected a function";function se(u, v, l){var s=!0,p=!0;if(typeof u!="function")throw new TypeError(qe);return be(l)&&(s="leading"in l?!!l.leading:s,p="trailing"in l?!!l.trailing:p),Be(u,v,{leading:s,maxWait:v,trailing:p})}const Ge=(u, v)=>{if(!N||!u||!v)return!1;const l=u.getBoundingClientRect();let s;return v instanceof Element?s=v.getBoundingClientRect():s={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},l.top<s.bottom&&l.bottom>s.top&&l.right>s.left&&l.left<s.right},Je=()=>N&&/firefox/i.test(window.navigator.userAgent),Qe=ve({urlList:{type:le(Array),default:()=>fe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),et={close:()=>!0,switch: u=>ce(u)},tt=["src"],at=Q({name:"ElImageViewer"}),nt=Q({...at,props:Qe,emits:et,setup(u, {expose:v,emit:l}){const s=u,p={CONTAIN:{name:"contain",icon:de(Le)},ORIGINAL:{name:"original",icon:de(Ce)}},L=Je()?"DOMMouseScroll":"mousewheel",{t:ee}=we(),r=me("image-viewer"),{nextZIndex:M}=Me(),g=b(),z=b([]),R=Ye(),w=b(!0),c=b(s.initialIndex),$=Fe(p.CONTAIN),i=b({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),D=k(()=>{const{urlList:t}=s;return t.length<=1}),X=k(()=>c.value===0),P=k(()=>c.value===s.urlList.length-1),Y=k(()=>s.urlList[c.value]),te=k(()=>{const{scale:t,deg:n,offsetX:o,offsetY:y,enableTransition:C}=i.value;let h=o/t,T=y/t;switch(n%360){case 90:case-270:[h,T]=[T,-h];break;case 180:case-180:[h,T]=[-h,-T];break;case 270:case-90:[h,T]=[-T,h];break}const A={transform:`scale(${t}) rotate(${n}deg) translate(${h}px, ${T}px)`,transition:C?"transform .3s":""};return $.value.name===p.CONTAIN.name&&(A.maxWidth=A.maxHeight="100%"),A}),j=k(()=>ce(s.zIndex)?s.zIndex:M());function x(){ne(),l("close")}function ae(){const t=se(o=>{switch(o.code){case V.esc:s.closeOnPressEscape&&x();break;case V.space:U();break;case V.left:q();break;case V.up:a("zoomIn");break;case V.right:G();break;case V.down:a("zoomOut");break}}),n=se(o=>{(o.wheelDelta?o.wheelDelta:-o.detail)>0?a("zoomIn",{zoomRate:s.zoomRate,enableTransition:!1}):a("zoomOut",{zoomRate:s.zoomRate,enableTransition:!1})});R.run(()=>{B(document,"keydown",t),B(document,L,n)})}function ne(){R.stop()}function W(){w.value=!1}function Z(t){w.value=!1,t.target.alt=ee("el.image.error")}function K(t){if(w.value||t.button!==0||!g.value)return;i.value.enableTransition=!1;const{offsetX:n,offsetY:o}=i.value,y=t.pageX,C=t.pageY,h=se(A=>{i.value={...i.value,offsetX:n+A.pageX-y,offsetY:o+A.pageY-C}}),T=B(document,"mousemove",h);B(document,"mouseup",()=>{T()}),t.preventDefault()}function F(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function U(){if(w.value)return;const t=ke(p),n=Object.values(p),o=$.value.name,C=(n.findIndex(h=>h.name===o)+1)%t.length;$.value=p[t[C]],F()}function H(t){const n=s.urlList.length;c.value=(t+n)%n}function q(){X.value&&!s.infinite||H(c.value-1)}function G(){P.value&&!s.infinite||H(c.value+1)}function a(t, n={}){if(w.value)return;const{zoomRate:o,rotateDeg:y,enableTransition:C}={zoomRate:s.zoomRate,rotateDeg:90,enableTransition:!0,...n};switch(t){case"zoomOut":i.value.scale>.2&&(i.value.scale=Number.parseFloat((i.value.scale/o).toFixed(3)));break;case"zoomIn":i.value.scale<7&&(i.value.scale=Number.parseFloat((i.value.scale*o).toFixed(3)));break;case"clockwise":i.value.deg+=y;break;case"anticlockwise":i.value.deg-=y;break}i.value.enableTransition=C}return oe(Y,()=>{ye(()=>{const t=z.value[0];t!=null&&t.complete||(w.value=!0)})}),oe(c, t=>{F(),l("switch",t)}),he(()=>{var t,n;ae(),(n=(t=g.value)==null?void 0:t.focus)==null||n.call(t)}),v({setActiveItem:H}),(t, n)=>(I(),re(je,{to:"body",disabled:!t.teleported},[d(Ee,{name:"viewer-fade",appear:""},{default:E(()=>[m("div",{ref_key:"wrapper",ref:g,tabindex:-1,class:f(e(r).e("wrapper")),style:ie({zIndex:e(j)})},[m("div",{class:f(e(r).e("mask")),onClick:n[0]||(n[0]=_e(o=>t.hideOnClickModal&&x(),["self"]))},null,2),_(" CLOSE "),m("span",{class:f([e(r).e("btn"),e(r).e("close")]),onClick:x},[d(e(O),null,{default:E(()=>[d(e(Te))]),_:1})],2),_(" ARROW "),e(D)?_("v-if",!0):(I(),S(ue,{key:0},[m("span",{class:f([e(r).e("btn"),e(r).e("prev"),e(r).is("disabled",!t.infinite&&e(X))]),onClick:q},[d(e(O),null,{default:E(()=>[d(e(Oe))]),_:1})],2),m("span",{class:f([e(r).e("btn"),e(r).e("next"),e(r).is("disabled",!t.infinite&&e(P))]),onClick:G},[d(e(O),null,{default:E(()=>[d(e(Se))]),_:1})],2)],64)),_(" ACTIONS "),m("div",{class:f([e(r).e("btn"),e(r).e("actions")])},[m("div",{class:f(e(r).e("actions__inner"))},[d(e(O),{onClick:n[1]||(n[1]= o=>a("zoomOut"))},{default:E(()=>[d(e(xe))]),_:1}),d(e(O),{onClick:n[2]||(n[2]= o=>a("zoomIn"))},{default:E(()=>[d(e(Ne))]),_:1}),m("i",{class:f(e(r).e("actions__divider"))},null,2),d(e(O),{onClick:U},{default:E(()=>[(I(),re(He(e($).icon)))]),_:1}),m("i",{class:f(e(r).e("actions__divider"))},null,2),d(e(O),{onClick:n[3]||(n[3]= o=>a("anticlockwise"))},{default:E(()=>[d(e(Re))]),_:1}),d(e(O),{onClick:n[4]||(n[4]= o=>a("clockwise"))},{default:E(()=>[d(e($e))]),_:1})],2)],2),_(" CANVAS "),m("div",{class:f(e(r).e("canvas"))},[(I(!0),S(ue,null,Xe(t.urlList,(o, y)=>Pe((I(),S("img",{ref_for:!0,ref: C=>z.value[y]=C,key:o,src:o,style:ie(e(te)),class:f(e(r).e("img")),onLoad:W,onError:Z,onMousedown:K},null,46,tt)),[[ze,y===c.value]])),128))],2),J(t.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var st=pe(nt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const lt=ge(st),ot=ve({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:le([String,Object])},previewSrcList:{type:le(Array),default:()=>fe([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),rt={load: u=>u instanceof Event,error: u=>u instanceof Event,switch: u=>ce(u),close:()=>!0,show:()=>!0},it=["src","loading"],ut={key:0},ct=Q({name:"ElImage",inheritAttrs:!1}),dt=Q({...ct,props:ot,emits:rt,setup(u, {emit:v}){const l=u;let s="";const{t:p}=we(),L=me("image"),ee=We(),r=Ie(),M=b(),g=b(!1),z=b(!0),R=b(!1),w=b(),c=b(),$=N&&"loading"in HTMLImageElement.prototype;let i,D;const X=k(()=>ee.style),P=k(()=>{const{fit:a}=l;return N&&a?{objectFit:a}:{}}),Y=k(()=>{const{previewSrcList:a}=l;return Array.isArray(a)&&a.length>0}),te=k(()=>{const{previewSrcList:a,initialIndex:t}=l;let n=t;return t>a.length-1&&(n=0),n}),j=k(()=>l.loading==="eager"?!1:!$&&l.loading==="lazy"||l.lazy),x=()=>{N&&(z.value=!0,g.value=!1,M.value=l.src)};function ae(a){z.value=!1,g.value=!1,v("load",a)}function ne(a){z.value=!1,g.value=!0,v("error",a)}function W(){Ge(w.value,c.value)&&(x(),F())}const Z=Ae(W,200);async function K(){var a;if(!N)return;await ye();const{scrollContainer:t}=l;Ve(t)?c.value=t:Ue(t)&&t!==""?c.value=(a=document.querySelector(t))!=null?a:void 0:w.value&&(c.value=De(w.value)),c.value&&(i=B(c,"scroll",Z),setTimeout(()=>W(),100))}function F(){!N||!c.value||!Z||(i==null||i(),c.value=void 0)}function U(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function H(){Y.value&&(D=B("wheel",U,{passive:!1}),s=document.body.style.overflow,document.body.style.overflow="hidden",R.value=!0,v("show"))}function q(){D==null||D(),document.body.style.overflow=s,R.value=!1,v("close")}function G(a){v("switch",a)}return oe(()=>l.src,()=>{j.value?(z.value=!0,g.value=!1,F(),K()):x()}),he(()=>{j.value?K():x()}),(a, t)=>(I(),S("div",{ref_key:"container",ref:w,class:f([e(L).b(),a.$attrs.class]),style:ie(e(X))},[M.value!==void 0&&!g.value?(I(),S("img",Ze({key:0},e(r),{src:M.value,loading:a.loading,style:e(P),class:[e(L).e("inner"),e(Y)&&e(L).e("preview"),z.value&&e(L).is("loading")],onClick:H,onLoad:ae,onError:ne}),null,16,it)):_("v-if",!0),z.value||g.value?(I(),S("div",{key:1,class:f(e(L).e("wrapper"))},[z.value?J(a.$slots,"placeholder",{key:0},()=>[m("div",{class:f(e(L).e("placeholder"))},null,2)]):g.value?J(a.$slots,"error",{key:1},()=>[m("div",{class:f(e(L).e("error"))},Ke(e(p)("el.image.error")),3)]):_("v-if",!0)],2)):_("v-if",!0),e(Y)?(I(),S(ue,{key:2},[R.value?(I(),re(e(lt),{key:0,"z-index":a.zIndex,"initial-index":e(te),infinite:a.infinite,"zoom-rate":a.zoomRate,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:q,onSwitch:G},{default:E(()=>[a.$slots.viewer?(I(),S("div",ut,[J(a.$slots,"viewer")])):_("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):_("v-if",!0)],64)):_("v-if",!0)],6))}});var ft=pe(dt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const yt=ge(ft);export{yt as E,se as t};
